extends /layouts/application.pug

block content
    .container.col-lg-6
        .py-1
            form(action=urlFor('tasks#new') method='get')
                button.btn.btn-block.btn-outline-primary(type='submit') New task
        .py-1
            form(action=urlFor('tasks#index'))
                button.btn.btn-block.btn-outline-primary(type='submit' name='creatorId' value=signedId()) Opened by me
        .py-1
            form(action=urlFor('tasks#index'))
                button.btn.btn-block.btn-outline-primary(type='submit' name='assignedToId' value=signedId()) Assigned to me
        .py-1
            +formSearch()
                +selectTags(tags)
                +selectStatus(statuses)
                +selectUsers(users)
                +button(f, 'Confirm')

    .container.col-lg-10
        table.table.table-striped
            thead
                tr
                    th.col-xs-1.col-md-1.small.text-nowrap
                        b ID
                    th.col-xs-1.col-md-1.small.text-nowrap
                        b Created At
                    th.col-xs-1.col-md-1.small.text-nowrap
                        b Status
                    th.col-xs-2.col-md-2.small.text-nowrap
                        b Task
                    th.col-xs-1.col-md-1.small.text-nowrap
                        b Tags
                    th.col-xs-2.col-md-2.small.text-nowrap
                        b Created By
                    th.col-xs-2.col-md-2.small.text-nowrap
                        b Assigned To
                    th.col-xs-2.col-md-2.small.text-nowrap
                        b Description
            tbody
                each task in tasks
                    tr
                        td.small
                                a(href=urlFor('tasks#show', { id: task.id }))= task.formattedId
                        td.small= formatDate(task.createdAt)
                        td.small= task.status
                        td.small= task.name
                        td.small
                            row
                                each tag in task.tags
                                    .d-inline.bg-info.rounded.p-1.mx-1.my-2= tag
                        td.small= task.creator
                        td.small= task.assignedTo
                        - const description = task.description.length < 51 ? task.description : `${task.description.slice(0,47)}...`
                        td.small= description